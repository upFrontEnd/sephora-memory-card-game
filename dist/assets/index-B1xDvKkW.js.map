{"version":3,"file":"index-B1xDvKkW.js","sources":["../../src/js/modules/theme-toggle.js","../../src/js/modules/sound.js","../../src/js/modules/shuffle.js","../../src/js/modules/game.js","../../src/js/main.js"],"sourcesContent":["const STORAGE_KEY = \"theme\"; // \"light\" | \"dark\"\r\n\r\nfunction getPreferredTheme() {\r\n  const saved = localStorage.getItem(STORAGE_KEY);\r\n  if (saved === \"light\" || saved === \"dark\") return saved;\r\n\r\n  const prefersDark = window.matchMedia?.(\"(prefers-color-scheme: dark)\")?.matches;\r\n  return prefersDark ? \"dark\" : \"light\";\r\n}\r\n\r\nfunction applyTheme(theme) {\r\n  const root = document.documentElement; // <html>\r\n  root.dataset.theme = theme;\r\n  root.style.colorScheme = theme; // aide les controls natifs\r\n\r\n  // Switch: on garde le visuel CodePen (checked = soleil / unchecked = lune)\r\n  const input = document.getElementById(\"theme-switch\");\r\n  if (input) {\r\n    input.checked = theme === \"light\";\r\n    input.setAttribute(\"aria-checked\", String(input.checked));\r\n  }\r\n\r\n  localStorage.setItem(STORAGE_KEY, theme);\r\n}\r\n\r\nexport function initThemeToggle() {\r\n  const input = document.getElementById(\"theme-switch\");\r\n  if (!input) return;\r\n\r\n  // init\r\n  applyTheme(getPreferredTheme());\r\n\r\n  // toggle\r\n  input.addEventListener(\"change\", () => {\r\n    const nextTheme = input.checked ? \"light\" : \"dark\";\r\n    applyTheme(nextTheme);\r\n  });\r\n}\r\n","const SOUND_PATHS = {\r\n  flip: \"/sound/flip.mp3\",     \r\n  match: \"/sound/match.mp3\",   \r\n  win: \"/sound/win.mp3\",       \r\n};\r\n\r\n// Volume par son (0 = muet, 1 = max)\r\nconst SOUND_VOLUME = {\r\n  flip: 1,\r\n  unflip: 1,\r\n  match: 1,\r\n  win: 0.1,\r\n};\r\n\r\n// Etat global du son (accessible par playSound)\r\nconst soundState = {\r\n  enabled: false, // état initial : son coupé\r\n};\r\n\r\n// Cache des instances Audio pour éviter de recréer à chaque fois\r\nconst audioMap = {};\r\n\r\n/**\r\n * Crée et configure une instance Audio pour un son.\r\n */\r\nfunction createAudio(key) {\r\n  const src = SOUND_PATHS[key];\r\n  if (!src) return null;\r\n\r\n  const audio = new Audio(src);\r\n  audio.preload = \"auto\";\r\n\r\n  const volume = SOUND_VOLUME[key];\r\n  audio.volume = typeof volume === \"number\" ? volume : 1;\r\n\r\n  audioMap[key] = audio;\r\n  return audio;\r\n}\r\n\r\n/**\r\n * Récupère (ou crée) une instance Audio pour un son donné.\r\n * @param {string} key - \"flip\" | \"match\" | \"win\"\r\n */\r\nfunction getAudio(key) {\r\n  if (audioMap[key]) return audioMap[key];\r\n  return createAudio(key);\r\n}\r\n\r\n/**\r\n * Précharge tous les sons au chargement de la page.\r\n * Appelle simplement .load() sur chaque Audio.\r\n */\r\nexport function preloadAllSounds() {\r\n  Object.keys(SOUND_PATHS).forEach((key) => {\r\n    const audio = getAudio(key);\r\n    if (audio) {\r\n      audio.load();\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * Joue un son si le son est activé.\r\n * @param {\"flip\" | \"match\" | \"win\"} name\r\n */\r\nexport function playSound(name) {\r\n  if (!soundState.enabled) return;\r\n\r\n  const audio = getAudio(name);\r\n  if (!audio) return;\r\n\r\n  audio.currentTime = 0;\r\n  audio.play().catch(() => {\r\n    // En cas de blocage navigateur, on ne casse pas le jeu\r\n  });\r\n}\r\n\r\n/**\r\n * Initialise le bouton de bascule du son (icône haut-parleur).\r\n * Met à jour soundState.enabled + l'UI (aria + classes).\r\n */\r\nexport function initSoundToggle() {\r\n  const button = document.querySelector(\".sound-toggle\");\r\n  if (!button) return;\r\n\r\n  function render() {\r\n    if (soundState.enabled) {\r\n      button.classList.add(\"sound-toggle--on\");\r\n      button.setAttribute(\"aria-pressed\", \"true\");\r\n      button.setAttribute(\"aria-label\", \"Désactiver le son\");\r\n    } else {\r\n      button.classList.remove(\"sound-toggle--on\");\r\n      button.setAttribute(\"aria-pressed\", \"false\");\r\n      button.setAttribute(\"aria-label\", \"Activer le son\");\r\n    }\r\n  }\r\n\r\n  button.addEventListener(\"click\", () => {\r\n    soundState.enabled = !soundState.enabled;\r\n    render();\r\n  });\r\n\r\n  // Premier rendu cohérent avec l'état initial (son OFF)\r\n  render();\r\n}\r\n","export function shuffleCards(cards) {\n  const total = cards.length;\n  cards.forEach((card) => {\n    card.style.order = Math.floor(Math.random() * total);\n  });\n}\n","import { shuffleCards } from \"./shuffle.js\";\nimport { playSound } from \"./sound.js\";\n\nexport function createGame() {\n  const cards = Array.from(document.querySelectorAll(\".memory-card\"));\n\n  const gameContainer = document.querySelector(\".memory-game\");\n  const overlay = document.querySelector(\".win-overlay\");\n  const replayButton = document.querySelector(\".replay-button\");\n\n  // === État du tour en cours ===\n  // hasFlippedCard : indique si on a déjà retourné une 1ère carte (on attend la 2e)\n  // lockBoard : bloque toute interaction pendant les animations/timeout (anti double-clics)\n  // firstCard / secondCard : références des 2 cartes retournées lors du tour\n  let hasFlippedCard = false;\n  let lockBoard = false;\n  let firstCard = null;\n  let secondCard = null;\n\n  // Réinitialise l’état du tour (après un match ou un non-match)\n  function resetBoard() {\n    hasFlippedCard = false;\n    lockBoard = false;\n    firstCard = null;\n    secondCard = null;\n  }\n\n  // Cas \"non match\" : on attend un peu, puis on re-retourne les deux cartes\n  function unflipCard() {\n    lockBoard = true; // on empêche de cliquer sur d’autres cartes pendant le délai\n\n    setTimeout(() => {\n      firstCard.classList.remove(\"flip\");\n      secondCard.classList.remove(\"flip\");\n      resetBoard();\n    }, 900);\n  }\n\n  // Cas \"match\" : on désactive les cartes et on les marque comme trouvées\n  function disableCards() {\n    lockBoard = true;\n    firstCard.removeEventListener(\"click\", flipCard);\n    secondCard.removeEventListener(\"click\", flipCard);\n\n    setTimeout(() => {\n      firstCard.classList.add(\"memory-card-shadow\");\n      secondCard.classList.add(\"memory-card-shadow\");\n\n      // Feedback audio + reset de l’état du tour, puis vérification de fin de partie\n      playSound(\"match\");\n      resetBoard();\n      allFlippedCard();\n    }, 900);\n  }\n\n  // Compare les deux cartes retournées : match si data-product identique\n  function checkForMatch() {\n    const isMatch = firstCard.dataset.product === secondCard.dataset.product;\n    isMatch ? disableCards() : unflipCard();\n  }\n\n  // Handler de clic sur une carte\n  function flipCard() {\n    // Si le plateau est verrouillé, on ignore les clics\n    if (lockBoard) return;\n    // Empêche de cliquer deux fois sur la même carte comme \"paire\"\n    if (this === firstCard) return;\n    // Retourne visuellement la carte\n    this.classList.add(\"flip\");\n    playSound(\"flip\");\n\n    // 1er clic : on mémorise la carte et on attend la 2e\n    if (!hasFlippedCard) {\n      hasFlippedCard = true;\n      firstCard = this;\n      return;\n    }\n\n    // 2e clic : on mémorise la carte et on lance la comparaison\n    hasFlippedCard = false;\n    secondCard = this;\n    checkForMatch();\n  }\n\n  // Vérifie si toutes les cartes ont été trouvées\n  function allFlippedCard() {\n    const total = cards.length;\n\n    // Les cartes \"trouvées\" ont la classe .memory-card-shadow\n    const matched = document.querySelectorAll(\".memory-card.memory-card-shadow\").length;\n\n    // Si toutes les cartes sont marquées \"trouvées\", fin de partie\n    if (total > 0 && matched === total) {\n      gameContainer.classList.add(\"win\"); // état global (utile pour styles/logic)\n      playSound(\"win\");\n      overlay.hidden = false; // affiche l’overlay de victoire + bouton \"Rejouer\"\n    }\n  }\n\n  // Réinitialise complètement la partie (appelée au clic sur \"Rejouer\")\n  function restartGame() {\n    resetBoard();\n\n    // Important : éviter d’empiler des listeners à chaque redémarrage\n    cards.forEach((card) => {\n      // Remet l’état visuel à zéro\n      card.classList.remove(\"flip\", \"memory-card-shadow\");\n\n      // Nettoie puis ré-attache le listener de clic\n      card.removeEventListener(\"click\", flipCard);\n      card.addEventListener(\"click\", flipCard);\n    });\n\n    // Nettoie l’état global + masque l’overlay\n    gameContainer.classList.remove(\"win\");\n    overlay.hidden = true;\n\n    // Mélange à nouveau les cartes (randomisation)\n    shuffleCards(cards);\n  }\n\n  // Démarre le jeu (à appeler une seule fois au chargement)\n  function mount() {\n    // Mélange initial\n    shuffleCards(cards);\n\n    // Ajoute le handler de clic sur chaque carte\n    cards.forEach((card) => card.addEventListener(\"click\", flipCard));\n\n    // Branche le bouton \"Rejouer\"\n    replayButton.addEventListener(\"click\", restartGame);\n\n    // État initial (pas de victoire affichée)\n    overlay.hidden = true;\n    gameContainer.classList.remove(\"win\");\n  }\n\n  // API minimale : le caller fait game.mount()\n  return { mount };\n}\n","import { initThemeToggle } from \"./modules/theme-toggle.js\";\nimport { initSoundToggle, preloadAllSounds } from \"./modules/sound.js\";\nimport { createGame } from \"./modules/game.js\";\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  preloadAllSounds();\n  initThemeToggle();\n  initSoundToggle();\n  initGame();\n});\n\nexport function initGame() {\n  const game = createGame();\n  game.mount();\n}\n"],"names":["STORAGE_KEY","getPreferredTheme","saved","applyTheme","theme","root","input","initThemeToggle","nextTheme","SOUND_PATHS","SOUND_VOLUME","soundState","audioMap","createAudio","key","src","audio","volume","getAudio","preloadAllSounds","playSound","name","initSoundToggle","button","render","shuffleCards","cards","total","card","createGame","gameContainer","overlay","replayButton","hasFlippedCard","lockBoard","firstCard","secondCard","resetBoard","unflipCard","disableCards","flipCard","allFlippedCard","checkForMatch","matched","restartGame","mount","initGame"],"mappings":"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"}